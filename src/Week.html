<script>
    export let user;
    export let firstDayOfTheWeek;
    export let days;
    export let disabledDays;
    let disabledDaysNumber = [];
    let onCall = [];
    
    let shift = days.indexOf(firstDayOfTheWeek);
    if(shift < 0) {
        shift = 0;
    }
    for (let _j = 0; _j < days.length; _j++) {
        let day = days[_j];
        let idxDayNumber = _j - shift;
        if (idxDayNumber < 0) {
            idxDayNumber = days.length + 1 + idxDayNumber;
        }
        if (disabledDays.indexOf(day) >= 0) {
            disabledDaysNumber[idxDayNumber] = true;
        } else {
            disabledDaysNumber[idxDayNumber] = false;
        }
    }

    const callClick = dayIndex => () => {
        if(onCall[dayIndex] == null) {
            onCall[dayIndex] = true;
        }else{
            onCall[dayIndex] = null;
        }
    };
</script>

<div class="week">
    <span class="cell week-row-header">{user}</span>
    {#each days as day, i}
    <span 
        on:click={callClick(i)}
        class:onCall="{onCall[i]}"
        class:disabled="{disabledDaysNumber[i]}"
        class="cell day">
    </span>
    {/each}
</div>

<style>
    /*@import "./styles_variables.less";*/
    .week-row-header {
        vertical-align: top;
        line-height: 25px;
        display: inline-block;
        width: 120px;
    }
    .day {
        margin: 4px;
        background-color: palegoldenrod;
        border-color: black;
        height: 20px;
        width: 20px;
        display: inline-block;
    }
    .cell {
    }
    .onCall {
        background-color: indianred;
    }
    .disabled {
        background-color: lightsteelblue;
    }
</style>